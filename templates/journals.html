{% extends "base.html" %}

{% block title %}Journals - LifeOS{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">ðŸ“” Journals</h1>
    <p class="page-subtitle">
        Personal journal entries and reflections for tracking thoughts and progress.
    </p>
</div>

<div class="database-container">
    <div class="database-header">
        <span class="database-title">Journal Entries ({{ journals|length if journals else 0 }} entries)</span>
        <button class="add-button" onclick="addNewJournal()">+ Add Entry</button>
    </div>
    
    {% if journals and journals|length > 0 %}
    <table class="database-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Title</th>
                <th>Content Preview</th>
                <th>Mood</th>
                <th>Tags</th>
            </tr>
        </thead>
        <tbody>
            {% for journal in journals %}
            <tr>
                <td style="color: var(--notion-text-light); font-size: 14px;">{{ journal.date or today }}</td>
                <td style="font-weight: 600;">{{ journal.title or 'Untitled Entry' }}</td>
                <td style="color: var(--notion-text-light);">{{ (journal.content or '')[:100] }}{% if journal.content and journal.content|length > 100 %}...{% endif %}</td>
                <td>
                    <span class="status-pill status-{{ (journal.mood or 'neutral').lower() }}">
                        {{ journal.mood or 'Neutral' }}
                    </span>
                </td>
                <td style="color: var(--notion-text-light); font-size: 12px;">{{ journal.tags or '' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div style="padding: 40px; text-align: center; color: var(--notion-text-light);">
        <p>No journal entries yet. Start writing your thoughts!</p>
    </div>
    {% endif %}
</div>

<script>
function addNewJournal() {
    const title = prompt('Journal entry title:');
    if (title) {
        const content = prompt('Content (or leave empty for now):');
        const mood = prompt('How are you feeling? (Good/Neutral/Bad):', 'Neutral');
        
        fetch('/add-item', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                table: 'journals',
                data: {
                    title: title,
                    content: content || '',
                    mood: mood || 'Neutral',
                    date: new Date().toISOString().split('T')[0],
                    tags: ''
                }
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                location.reload();
            } else {
                alert('Failed to add journal entry');
            }
        });
    }
}
</script>
{% endblock %}